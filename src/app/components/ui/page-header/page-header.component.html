<div
  class="flex-none flex items-center justify-between gap-2 bg-surface-0 dark:bg-surface-900 p-2 sm:p-3 ml-12 sm:ml-0"
>
  <div class="flex items-center gap-2 sm:gap-3">
    <!-- Ícone da Página -->
    <div
      class="w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-primary-50 dark:bg-primary-900/20 flex items-center justify-center"
    >
      <i [class]="'pi ' + displayIcon() + ' text-primary text-lg sm:text-xl'"></i>
    </div>

    <!-- Título da Página -->
    <h1 class="text-sm sm:text-xl font-bold text-surface-900 dark:text-surface-0 m-0">
      {{ displayTitle() | translate }}
    </h1>
  </div>

  <!-- Ações à Direita -->
  <div class="flex items-center gap-2">
    <!-- Slot para múltiplas ações via Template (Recomendado) -->
    <ng-container *ngTemplateOutlet="actionsTemplate()"></ng-container>

    <!-- Slot para conteúdo projetado -->
    <ng-content></ng-content>

    <!-- Ação à Direita Legada (Opcional) -->
    @if (showAction()) {
      <p-button
        [icon]="actionIcon()"
        [label]="actionLabel() | translate"
        (onClick)="handleAction()"
        [pTooltip]="actionTooltip() | translate"
        tooltipPosition="left"
        [size]="'small'"
        class="flex-shrink-0"
      />
    }


    <!-- Indicador de Casa Ativa -->
    <div
      class="flex flex-col items-center leading-none gap-1 cursor-pointer hover:opacity-80 transition-opacity px-2 border rounded-lg p-0.5"
      (click)="op.toggle($event)"
      pTooltip="Trocar Casa Ativa"
      tooltipPosition="left"
    >
      <i class="pi pi-home text-lg text-primary"></i>
      <span class="text-[8px] font-bold uppercase tracking-wider text-surface-700 dark:text-surface-300">
        {{ activeHouseName() }}
      </span>
    </div>

    <!-- Popover para Seleção de Casa -->
    <p-popover #op>
      <div class="flex flex-col gap-3 min-w-[250px] p-1">
        <div class="flex items-center gap-2 mb-1">
          <i class="pi pi-home text-primary"></i>
          <span class="font-bold text-surface-900 dark:text-surface-0">Selecione a Casa</span>
        </div>

        <p-select
           [(ngModel)]="currentHouse"
           [options]="houses()"
           optionLabel="name"
           [showClear]="false"
           class="w-full !bg-surface-100 dark:!bg-surface-800 !border-surface-300 dark:!border-surface-600"
           appendTo="body"
           (onChange)="op.hide()"
         >
          <ng-template pTemplate="selectedItem" let-selectedOption>
            <div class="flex items-center gap-2">
              <i class="pi pi-home text-primary"></i>
              <span class="font-medium">{{ selectedOption.name }}</span>
            </div>
          </ng-template>
          <ng-template pTemplate="item" let-house>
            <div class="flex items-center gap-3 py-1">
              <i class="pi pi-home text-primary"></i>
              <div class="flex flex-col">
                <span class="font-medium">{{ house.name }}</span>
                <span class="text-xs text-surface-500">{{ house.code }}</span>
              </div>
            </div>
          </ng-template>
        </p-select>
      </div>
    </p-popover>
  </div>
</div>
