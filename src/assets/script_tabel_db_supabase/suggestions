-- Criar a tabela de sugestões
CREATE TABLE IF NOT EXISTS public.suggestions (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    title TEXT NOT NULL,
    description TEXT NOT NULL,
    status TEXT NOT NULL DEFAULT 'PENDING'
        CHECK (status IN ('PENDING', 'IN_PROGRESS', 'COMPLETED', 'REJECTED')),
    answer TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    user_id UUID -- Opcional: vincular a um usuário se tiver autenticação
);

-- Habilitar Row Level Security (RLS)
ALTER TABLE public.suggestions ENABLE ROW LEVEL SECURITY;

-- Criar política para permitir que qualquer pessoa leia as sugestões (ajuste conforme necessário)
CREATE POLICY "Allow public read access" ON public.suggestions
    FOR SELECT USING (true);

-- Criar política para permitir inserção pública (ou autenticada)
CREATE POLICY "Allow public insert access" ON public.suggestions
    FOR INSERT WITH CHECK (true);

-- Criar política para permitir atualização (ex: admin respondendo)
CREATE POLICY "Allow public update access" ON public.suggestions
    FOR UPDATE USING (true);

-- Criar política para permitir exclusão
CREATE POLICY "Allow public delete access" ON public.suggestions
    FOR DELETE USING (true);
